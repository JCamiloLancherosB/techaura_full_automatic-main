# ===========================================
# TechAura Bot - Environment Configuration
# ===========================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env file to version control

# ===========================================
# Database Provider Configuration (MYSQL SSOT)
# ===========================================
# DB_PROVIDER: Database provider to use
# IMPORTANTE: Solo se permite 'mysql' (MySQL SSOT enforcement)
# SQLite está BLOQUEADO en runtime para garantizar consistencia
# Si no se especifica, se asume 'mysql' por defecto
# Valores permitidos: mysql (único valor permitido)
DB_PROVIDER=mysql

# ===========================================
# MySQL Database Configuration (REQUIRED)
# ===========================================
# These variables are REQUIRED for the application to run
# The application will fail to start if they are not configured

# MySQL Host - Server donde está corriendo MySQL (default: localhost)
MYSQL_DB_HOST=localhost

# MySQL Port - Puerto de MySQL (default: 3306)
MYSQL_DB_PORT=3306

# MySQL User - Usuario de MySQL que se conectará a la base de datos
# IMPORTANTE: Crea este usuario en MySQL antes de ejecutar la aplicación
# Ejemplo de creación:
#   CREATE USER 'techaura_bot'@'localhost' IDENTIFIED BY 'tu_password_seguro';
#   GRANT ALL PRIVILEGES ON techaura_bot.* TO 'techaura_bot'@'localhost';
#   FLUSH PRIVILEGES;
MYSQL_DB_USER=techaura_bot

# MySQL Password - Contraseña del usuario de MySQL
# IMPORTANTE: Esta variable es REQUERIDA. No puede estar vacía.
MYSQL_DB_PASSWORD=your_secure_mysql_password

# MySQL Database - Nombre de la base de datos
# IMPORTANTE: Crea esta base de datos en MySQL antes de ejecutar la aplicación
# Ejemplo de creación:
#   CREATE DATABASE techaura_bot CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
MYSQL_DB_NAME=techaura_bot

# Alternative DB env vars (for compatibility with server.js)
# Estas variables son opcionales si ya configuraste las MYSQL_DB_* arriba
# El sistema usará MYSQL_DB_* primero, luego DB_* si no encuentra las primeras
DB_HOST=localhost
DB_USER=techaura_bot
DB_PASS=your_secure_mysql_password
DB_NAME=techaura_bot
DB_PORT=3306

# ===========================================
# Instrucciones de Configuración de MySQL
# ===========================================
# 1. Instala MySQL si no lo tienes:
#    Ubuntu/Debian: sudo apt-get install mysql-server
#    macOS: brew install mysql
#    Windows: Descarga desde https://dev.mysql.com/downloads/mysql/
#
# 2. Inicia MySQL:
#    Ubuntu/Debian: sudo systemctl start mysql
#    macOS: brew services start mysql
#
# 3. Conéctate a MySQL como root:
#    mysql -u root -p
#
# 4. Crea la base de datos:
#    CREATE DATABASE techaura_bot CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
#
# 5. Crea el usuario:
#    CREATE USER 'techaura_bot'@'localhost' IDENTIFIED BY 'tu_password_seguro';
#
# 6. Otorga permisos:
#    GRANT ALL PRIVILEGES ON techaura_bot.* TO 'techaura_bot'@'localhost';
#    FLUSH PRIVILEGES;
#
# 7. Verifica:
#    SHOW DATABASES LIKE 'techaura_bot';
#    SHOW GRANTS FOR 'techaura_bot'@'localhost';
#    EXIT;
#
# 8. Prueba la conexión:
#    mysql -u techaura_bot -p techaura_bot
#
# 9. Actualiza este archivo .env con las credenciales correctas
#
# 10. Ejecuta las migraciones:
#     npx knex migrate:latest

# ===========================================
# Server Configuration
# ===========================================
PORT=3006
NODE_ENV=development

# ===========================================
# AI Services (Required)
# ===========================================
# Gemini API key from Google AI Studio
GEMINI_API_KEY=your_gemini_api_key_here

# Optional: Gemini model to use (default: gemini-1.5-flash)
# The system will automatically fall back to other models if the specified model is unavailable
# Fallback chain: GEMINI_MODEL -> gemini-1.5-flash -> gemini-1.5-pro -> gemini-pro
GEMINI_MODEL=gemini-1.5-flash

# Optional: Cohere API for enhanced AI features
COHERE_API_KEY=your_cohere_api_key_here

# Optional: OpenAI API for additional AI capabilities
OPENAI_API_KEY=your_openai_api_key_here

# ===========================================
# Email Configuration (for notifications)
# ===========================================
MAIL_USER=your_email@gmail.com
MAIL_PASS=your_app_password_here

# ===========================================
# Content Paths (optional, defaults provided)
# ===========================================
MUSIC_ROOT=/path/to/music/library
VIDEO_ROOT=/path/to/video/library
MOVIES_ROOT=/path/to/movies/library
SERIES_ROOT=/path/to/series/library

# ===========================================
# Processing Configuration
# ===========================================
MAX_CONCURRENT_JOBS=3
AUTO_PROCESSING_ENABLED=true
RETRY_DELAY=5000
MAX_RETRIES=3

# ===========================================
# WhatsApp Configuration
# ===========================================
# Phone number for WhatsApp bot (optional)
BOT_PHONE_NUMBER=

# ===========================================
# Admin Configuration
# ===========================================
# Comma-separated list of admin phone numbers
ADMIN_PHONES=573008602789

# ===========================================
# Logging
# ===========================================
LOG_LEVEL=info

# ===========================================
# PII Encryption
# ===========================================
# AES-256-GCM encryption key for PII data (phone numbers, addresses)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# REQUIRED in production for encrypting sensitive shipping data
PII_ENCRYPTION_KEY=your_32_byte_hex_key_here_64_characters_total_length_is_needed

# ===========================================
# Notificador Service Integration (Optional)
# ===========================================
# External notification service for automated WhatsApp/SMS/Email notifications
# such as order confirmations, payment receipts, status updates, and campaigns.
#
# STATUS: The Notificador service is OPTIONAL. If NOTIFIER_BASE_URL and 
# NOTIFIER_API_KEY are not set, the service will be disabled with a warning.
# This is normal for development environments.
#
# REQUIRED for Notificador Service:
# - NOTIFIER_BASE_URL: The base URL of your Notificador service API
# - NOTIFIER_API_KEY: Your API key for authentication
#
# Without these two variables, NotificadorService will be disabled and the
# /v1/health endpoint will show notifier status as "disabled".
#
# To enable NotificadorService:
# 1. Deploy or obtain access to a Notificador service instance
# 2. Set NOTIFIER_BASE_URL to the API endpoint (e.g., https://your-notificador.example.com/api/v1)
# 3. Set NOTIFIER_API_KEY to your authentication key
# 4. Configure optional parameters below as needed
#
# Health indicator: Check /v1/health endpoint for notifier.enabled status

# Base URL of the Notificador service API (REQUIRED for enabling notifications)
NOTIFIER_BASE_URL=https://notificador.example.com/api/v1

# API Key for authenticating with Notificador service (REQUIRED for enabling notifications)
NOTIFIER_API_KEY=your_notificador_api_key_here

# Default WhatsApp number for sending notifications (format: 573008602789)
DEFAULT_WHATSAPP_NUMBER=3008602789

# Default email sender address
DEFAULT_EMAIL_FROM=noreply@techaura.com

# Notificador service timeout in milliseconds (default: 30000)
NOTIFIER_TIMEOUT=30000

# Maximum number of retries for failed requests (default: 3)
NOTIFIER_MAX_RETRIES=3

# Delay between retries in milliseconds (default: 1000)
NOTIFIER_RETRY_DELAY=1000

# ===========================================
# MySQL SSOT Production Enforcement
# ===========================================
# Controls behavior when SQLite modules are detected in production.
# The system enforces MySQL as the Single Source of Truth (SSOT).
#
# SQLITE_PRODUCTION_MODE options:
# - 'fail' (default): Application fails to start if SQLite modules are found
# - 'warn': Logs ERROR but allows startup (use with caution)
#
# In development: SQLite detection always emits warnings without failing
SQLITE_PRODUCTION_MODE=fail
